repos:
  - repo: local
    hooks:
      - id: mypy
        name: mypy-type-check
        entry: make lint
        language: system
        pass_filenames: false
        types: [python]
      - id: ruff-check
        name: ruff-check
        entry: make ruff-check
        language: system
        pass_filenames: false
        types: [python]
      - id: ruff-fix
        name: ruff-fix
        entry: make ruff-fix
        language: system
        pass_filenames: false
        types: [python]
      - id: ruff-format
        name: ruff-format
        entry: make ruff-format
        language: system
        pass_filenames: false
        types: [python]

  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-added-large-files
      - id: check-merge-conflict
      - id: check-toml

  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v3.0.3
    hooks:
      - id: prettier
        files: \.(js|jsx|ts|tsx|json|css|scss|md|html)$
        exclude: |
          (?x)^(
            node_modules/.*|
            venv/.*
          )$

  - repo: local
    hooks:
      - id: clear-python-cache
        name: Clear Python cache files
        entry: make clean-cache
        language: system
        pass_filenames: false
        always_run: true

      - id: django-check
        name: Django initialization check
        entry: make django-check
        language: system
        pass_filenames: false

      - id: django-import-check
        name: Django management command import test
        entry: make django-import-check
        language: system
        pass_filenames: false

      - id: check-pip-dependencies
        name: Check pip dependency compatibility
        entry: bash -c "cd django_backend && source venv/bin/activate && python -m pip install --dry-run -e .."
        language: system
        pass_filenames: false
        verbose: false

      - id: python-import-check
        name: Python import validation
        entry: python -m py_compile
        language: python
        language_version: python3.13
        types: [python]
        exclude: |
          (?x)^(
            venv/.*|
            .venv/.*|
            .*/migrations/.*
          )$

      - id: backend-startup-check
        name: Backend startup validation
        entry: make backend-startup-check
        language: system
        pass_filenames: false
